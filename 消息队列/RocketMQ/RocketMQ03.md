# 1 消息存储

分布式队列因为有高可靠性的要求，索引数据要进行持久化存储。

![image-20220920154516471](https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220920154516471.png)

## 1.1 存储介质

- 关系型数据库

关系型数据库可以实现 JDBC 消息存储。由于，普通关系型数据库（如MySQL）在单表数据量达到千万级别的情况下，其IO读写性能往往会出现瓶颈。在可靠性方面，这种方案非常依赖 DB，如果DB一旦出现问题，则 MQ 的消息无法罗盘存储会导致线上故障

- 文件系统

消息刷盘为消息存储提供一种高效率，可靠性和高性能的数据持久化方式。除非 MQ 机器本身挂了，否则一般是不会出现无法持久化的故障问题

### 1.1.1 性能对比

文件系统 > 关系型数据库

































