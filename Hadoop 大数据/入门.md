![image-20220611201130390](https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220611201130390.png)

1）服务器之间的拷贝

基本语法

```bash
scp		-r		$pdir/fname				$user@host:$pdir/$fname
命令	  递归	要拷贝的文件路径/名称		目的地用户@主机：目的路径/名称
```



2）rsync 远程==同步==工具

rsync 主要用于备份和镜像，具有速度快、避免复制相同内容和支持链接的优点。

==rsync 和 scp 区别：==用 rsync 做文件的赋值要比 scp 的速度快，rsync 只对差异文件做更新。scp 是将所有文件都复制过去

基本语法

```bash
rsync	-av		$pdir/$fname			$user@host:$pdir/$fname
命令	选项参数	要拷贝的文件路径/名称		目的地用户@主机：目的地路径/名称
```

选项参数说明

| 选项 | 功能         |
| ---- | ------------ |
| -a   | 文档拷贝     |
| -v   | 限制复制过程 |



**启动单个 datanode**

命令：`hdfs --daemon start datanode`



# 搭建 Hadoop 集群

先进行硬件的安装

![image-20220613144219784](https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613144219784.png)

## 安装 CentOS —— 硬件

点击创建虚拟机出现下面弹窗，之后跟着图片下一步

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143322244.png" alt="image-20220613143322244" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143436939.png" alt="image-20220613143436939" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143452270.png" alt="image-20220613143452270" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143514811.png" alt="image-20220613143514811" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143730787.png" alt="image-20220613143730787" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143743965.png" alt="image-20220613143743965" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143801508.png" alt="image-20220613143801508" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143842049.png" alt="image-20220613143842049" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143911283.png" alt="image-20220613143911283" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143922315.png" alt="image-20220613143922315" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613143943281.png" alt="image-20220613143943281" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613144009821.png" alt="image-20220613144009821" style="zoom:50%;" />

下一步之后完成

## 安装系统 （CentOS7）—— 软件

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613144310505.png" alt="image-20220613144310505" style="zoom:50%;" />

选择 CentOS7 镜像安装

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613144532268.png" alt="image-20220613144532268" style="zoom:50%;" />

点击确定之后开启虚拟机

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613144810508.png" alt="image-20220613144810508" style="zoom: 67%;" />

之后会看到下面 CentOS 这样一界面：选择中文之后，点击继续

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613144948953.png" alt="image-20220613144948953" style="zoom:50%;" />

设置日期和时间

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145031258.png" alt="image-20220613145031258" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145126612.png" alt="image-20220613145126612" style="zoom:50%;" />

完成之后，进行 **软件选择** 

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145258424.png" alt="image-20220613145258424" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145321602.png" alt="image-20220613145321602" style="zoom:50%;" />

选择最小安装 或者 桌面都是可以的。

接下来处理**安装位置**

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145455613.png" alt="image-20220613145455613" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145523265.png" alt="image-20220613145523265" style="zoom:50%;" />

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145612335.png" alt="image-20220613145612335" style="zoom:50%;" />

上图 /boot 表示启动时需要的内存，1个G就可以了

接下来配置网络和主机名称

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613145826318.png" alt="image-20220613145826318" style="zoom:50%;" />

## 配置 IP 地址

![image-20220613152653429](https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220613152653429.png)





















/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/opt/module/jdk1.8.0_291/bin:/opt/module/hadoop-3.3.3/bin:/opt/module/hadoop-3.3.3/sbin:/home/atguigu/.local/bin:/home/lixianghong/bin





































```sh
#!/bin/bash
#1. 判断参数个数
if [ $# -lt 1 ]
then
 echo Not Enough Arguement!
 exit;
fi
#2. 遍历集群所有机器
for host in hadoop102 hadoop103 hadoop104
do
 echo ==================== $host ====================
 #3. 遍历所有目录，挨个发送
 for file in $@
 do
 #4. 判断文件是否存在
 if [ -e $file ]
 then
 #5. 获取父目录
 pdir=$(cd -P $(dirname $file); pwd)
 #6. 获取当前文件的名称
 fname=$(basename $file)
 ssh $host "mkdir -p $pdir"
 rsync -av $pdir/$fname $host:$pdir
 else
 echo $file does not exists!
 fi
 done
done




#!/bin/bash

if [ $# -lt 1 ]
then
  echo "No args Input..."
  exit;
fi

case $1 in
"start")
  echo "============= 启动hadoop集群 ======================"

  echo "------------- 启动 hdfs ---------------------------"
  ssh hadoop102 "/opt/module/hadoop-3.3.3/sbin/start-dfs.sh"
  echo "------------- 启动 yarn ---------------------------"
  ssh hadoop103 "/opt/module/hadoop-3.3.3/sbin/start-yarn.sh"
  echo "---------- 启动 historyserver ----------------------"
  ssh hadoop102 "/opt/module/hadoop-3.3.3/bin/mapred --daemon start historyserver"
;;
"stop")
  echo "================ 关闭hadoop集群 =========================="

  echo "-------------- 关闭historyserver ------------------------"
  ssh hadoop102 "/opt/module/hadoop-3.3.3/bin/mapred --daemon stop historyserver"
  echo "---------------- 关闭 yarn ------------------------------"
  ssh hadoop103 "/opt/module/hadoop-3.3.3/sbin/stop-yarn.sh"
  echo "---------------- 关闭 hdfs ------------------------------"
  ssh hadoop102 "/opt/module/hadoop-3.3.3/sbin/stop-dfs.sh"
;;
*)
  echo "Input Args Error..."
;;
esac
```





