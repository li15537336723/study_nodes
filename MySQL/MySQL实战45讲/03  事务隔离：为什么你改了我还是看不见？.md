# 03 | 事务隔离：为什么你改了不还看不见？

在数据库中，事务是一个非常重要的环节，最经典的例子就是转账，转账前后要求，金钱的总金额是一定的。

事务就是要保证一组数据库操作，要么全部成功，要么全部失败。



## 隔离性与隔离级别

提到事务，ACID，即**原子性，隔离性，持久性，一致性**。

当数据库上有多个事务同时执行的时候，就可能会出现**脏读，不可重复读，幻读**的问题，为了解决这些问题，数据库就有了 “隔离级别” 的概念。

SQL标准的事务隔离级别：**读未提交，读已提交，可重复读和串行化**。

**读未提交：**指一个事务还没提交时，他做的改变就能够被其他事务所看到

**读已提交：**一个事务提交之后，它做的变更才能被其他事务看到。

**可重复读：**指一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。当然在可重复读隔离级别写，未提交变更对其他事务也是不可见的。

<img src="https://lixianghong.oss-cn-beijing.aliyuncs.com/typore/image-20220302092042414.png" alt="image-20220302092042414" style="zoom:50%;" />

来看一下在不同事务的隔离级别下，事务 A 会有哪些不同的返回结果，也就是图里面 V1，V2，V3 的返回值分别是什么？

若隔离级别是 “读未提交”，则 V1 的值就是 2，V2 的值也是2，V3 的值也是2。

若隔离级别是 “读提交”，V1 的值是1，V2 的值是2，V3 的值是2。

若隔离级别是 “可重复读”，V1 的值是 1，V2 的值是1，V3 的值是2。遵循要求：事务再执行期间看到的数据前后必须是一致的。

































































































